<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>Iecook - thisago's blog</title>
  <link rel="icon" href="https://avatars.githubusercontent.com/u/74574275?s=48&v=4">
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="nimib 0.3.9" name="generator">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.min.css"><link rel="stylesheet" href="../../style/main.css" />
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/pietroppeter/nimib/assets/androidstudio.css'>
    <script src="https://cdn.jsdelivr.net/gh/pietroppeter/nimib@main/assets/highlight.min.js"></script>
<script>hljs.highlightAll();</script>

  <style>
.nb-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.nb-small {
  font-size: 0.8rem;
}
button.nb-small {
  float: right;
  padding: 2px;
  padding-right: 5px;
  padding-left: 5px;
}
section#source {
  display:none
}
pre > code {
  font-size: 1.2em;
}
.nb-output {
  line-height: 1.15;
}
</style>
  
</head>
<body>
<header>
<div class="nb-box">
  <span><a href="../../../../..">üè°</a></span>
  <span><a target="_blank" rel="noopener noreferrer" href="https://github.com/thisago/blog/tree/master/src/blogpkg/pages/posts/projects/iecook.nim"><code>src/blogpkg/pages/posts/projects/iecook.nim</code></a></span>
  <span><a href="https://github.com/thisago/blog"><svg aria-hidden="true" width="1.2em" height="1.2em" style="vertical-align: middle; fill: #fff" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a></span>
</div>
<hr>
</header><main>
<h4 class="category">projects</h4>
<h1>iecook</h1>
<p>Hi again, have you ever needed to get the browser session automatically?<br />
Well, now with <code>httpOnly</code> option for cookies, makes harder to do this task, since
it aren't available to Javascript read and write.</p>
<p>When developing integrations with some private APIs with reverse engineer, I
faced this issue.</p>
<p>One example is my <a href="https://github.com/thisago/bard">Google Bard batchexecute API implementation</a>,
this library uses an session cookie (<code>__Secure-1PSIDTS</code>) that expires after some
usage, but since I needed to make it fully automatic, I created <strong>iecook</strong>.</p>
<p>The first need was get Google session cookies, that's why it was previously
called <a href="https://github.com/thisago/iecook/tree/9fb64ef5aafe0fadeb399245aec523326055f440">Gookie</a></p>
<p>But now, iecook, can get the cookies from any website, just import it:</p>
<pre><code class="nohighlight hljs nim"><span class="hljs-keyword">import</span> pkg/iecook</code></pre>
<p>And run:</p>
<pre><code class="nohighlight hljs nim"><span class="hljs-keyword">var</span> allCookies = iecook <span class="hljs-string">&quot;https://example.com&quot;</span></code></pre>
<p>The proc <code>iecook</code> returns to you all cookies of all browser's
contexts (containers). And in chrome, since there's no multiple containers like
in Firefox, just a default container is returned.</p>
<pre><code class="nohighlight hljs nim"><span class="hljs-keyword">for</span> (context, cookies) <span class="hljs-keyword">in</span> allCookies:
  <span class="hljs-keyword">echo</span> <span class="hljs-string">fmt&quot;Got {cookies.len} cookies from {context}: '{cookies}'&quot;</span></code></pre><pre class="nb-output">Got 2 cookies from firefox-container-1: 'session=psRXXrIDRCWlfyGnf1RA;userId=5235'
Got 3 cookies from firefox-container-2: 'session=2lgScP6s5wMHGzJn3m8J;userId=6784;anotherOne=Hello World! Again'</pre>
<h2>How it works?</h2>
<p>As said before, most of Javascript contexts haven't access to <code>httpOnly</code> cookies,
even in a userscript.<br />
But extensions can access it.</p>
<p>This library, basically opens a HTTP server that have just two routes. One to
provide the requested domain and other to receive the cookies.
the extension tries to request the domain all the time, and when server is opened,
it retrieve the cookies of all contexts and sends to you.</p>
<p>When server receives the cookies, it closes the server and return it to you.</p>
<h2>Should I use this?</h2>
<p>This is a workaround, a dirty workaround. In order to this solution works, you
need to keep open your web browser with <strong>iecook</strong> installed and your application
will freeze until receive the cookies.</p>
<p>This isn't a solution for production and keep in mind that is potentially
dangerous keeping installed the client extension, because a malicious application
can request your cookies without your consent.</p>
<h2>Project using it</h2>
<p>A project that uses *<em>iecook</em> to get Cookies, is <a href="https://github.com/thisago/clibard">clibard</a>,
an Google Bard CLI chat that uses the Google Bard private API</p>
<h2>Why iecook as name?</h2>
<p>This name is just <strong>cook</strong>ie with the <code>ie</code> moved  to start. There's no extra,
meaning :)</p>
<h2>Outro</h2>
<p>Thanks for reading, if you want to read more and try by yourself, continue reading
at <a href="https://github.com/thisago/iecook">iecook repository</a>.</p>
</main>
<footer>
<div class="nb-box">
  <span><span class="nb-small">made with <a href="https://pietroppeter.github.io/nimib/">nimib üê≥</a></span></span>
  <span></span>
  <span><button class="nb-small" id="show" onclick="toggleSourceDisplay()">Show Source</button></span>
</div>
</footer>
<section id="source">
<pre><code class="nohighlight nim hljs"><span class="hljs-keyword">from</span> std/strformat <span class="hljs-keyword">import</span> fmt

<span class="hljs-keyword">import</span> pkg/nimib

<span class="hljs-keyword">import</span> pkg/iecook

<span class="hljs-keyword">import</span> incl/post

post:
  nbText <span class="hljs-string">fmt&quot;&quot;&quot;
# iecook
Hi again, have you ever needed to get the browser session automatically?  
Well, now with `httpOnly` option for cookies, makes harder to do this task, since
it aren't available to Javascript read and write.

When developing integrations with some private APIs with reverse engineer, I
faced this issue.

One example is my [Google Bard batchexecute API implementation](https://github.com/thisago/bard),
this library uses an session cookie (`__Secure-1PSIDTS`) that expires after some
usage, but since I needed to make it fully automatic, I created **iecook**.

The first need was get Google session cookies, that's why it was previously
called [Gookie](https://github.com/thisago/iecook/tree/9fb64ef5aafe0fadeb399245aec523326055f440)

But now, iecook, can get the cookies from any website, just import it:
&quot;&quot;&quot;</span>
  nbCodeSkip:
    <span class="hljs-keyword">import</span> pkg/iecook
  nbText <span class="hljs-string">fmt&quot;And run:&quot;</span>
  nbCodeSkip:
    <span class="hljs-keyword">var</span> allCookies = iecook <span class="hljs-string">&quot;https://example.com&quot;</span>

  nbText <span class="hljs-string">fmt&quot;&quot;&quot;The proc `iecook` returns to you all cookies of all browser's
contexts (containers). And in chrome, since there's no multiple containers like
in Firefox, just a default container is returned.
&quot;&quot;&quot;</span>
  <span class="hljs-keyword">var</span> allCookies: <span class="hljs-type">IeCookList</span> = @[
    (<span class="hljs-string">&quot;firefox-container-1&quot;</span>, @[
      (<span class="hljs-string">&quot;session&quot;</span>, <span class="hljs-string">&quot;psRXXrIDRCWlfyGnf1RA&quot;</span>),
      (<span class="hljs-string">&quot;userId&quot;</span>, <span class="hljs-string">&quot;5235&quot;</span>),
    ]),
    (<span class="hljs-string">&quot;firefox-container-2&quot;</span>, @[
      (<span class="hljs-string">&quot;session&quot;</span>, <span class="hljs-string">&quot;2lgScP6s5wMHGzJn3m8J&quot;</span>),
      (<span class="hljs-string">&quot;userId&quot;</span>, <span class="hljs-string">&quot;6784&quot;</span>),
      (<span class="hljs-string">&quot;anotherOne&quot;</span>, <span class="hljs-string">&quot;Hello World! Again&quot;</span>)
    ])
  ]
  nbCode:
    <span class="hljs-keyword">for</span> (context, cookies) <span class="hljs-keyword">in</span> allCookies:
      <span class="hljs-keyword">echo</span> <span class="hljs-string">fmt&quot;Got {cookies.len} cookies from {context}: '{cookies}'&quot;</span>
  nbText <span class="hljs-string">fmt&quot;&quot;&quot;
## How it works?
As said before, most of Javascript contexts haven't access to `httpOnly` cookies,
even in a userscript.  
But extensions can access it.

This library, basically opens a HTTP server that have just two routes. One to
provide the requested domain and other to receive the cookies.
the extension tries to request the domain all the time, and when server is opened,
it retrieve the cookies of all contexts and sends to you.

When server receives the cookies, it closes the server and return it to you.

## Should I use this?
This is a workaround, a dirty workaround. In order to this solution works, you
need to keep open your web browser with **iecook** installed and your application
will freeze until receive the cookies.

This isn't a solution for production and keep in mind that is potentially
dangerous keeping installed the client extension, because a malicious application
can request your cookies without your consent.

## Project using it
A project that uses **iecook* to get Cookies, is [clibard](https://github.com/thisago/clibard),
an Google Bard CLI chat that uses the Google Bard private API

## Why iecook as name?
This name is just **cook**ie with the `ie` moved  to start. There's no extra,
meaning :)

## Outro
Thanks for reading, if you want to read more and try by yourself, continue reading
at [iecook repository](https://github.com/thisago/iecook).
&quot;&quot;&quot;</span>
</code></pre>
</section><script>
function toggleSourceDisplay() {
  var btn = document.getElementById("show")
  var source = document.getElementById("source");
  if (btn.innerHTML=="Show Source") {
    btn.innerHTML = "Hide Source";
    source.style.display = "block";
  } else {
    btn.innerHTML = "Show Source";
    source.style.display = "none";
  }
}
</script></body>
</html>